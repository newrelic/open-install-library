---
- name: Install CrowdStrike Falcon Sensor
  block:
    - include_role:
        name: newrelic.crowdstrike_provision.install_crowdstrike_falcon
  vars:
    gather_facts: true
    ansible_become: true
    ansible_become_method: "{{ (ansible_facts['os_family'] == 'Windows') | ternary('runas', 'sudo') }}"
    ansible_become_user: "{{ ansible_user }}"
    falcon_client_id: "{{ lookup('env', 'CROWDSTRIKE_CLIENT_ID') }}"
    falcon_client_secret: "{{ lookup('env', 'CROWDSTRIKE_CLIENT_SECRET') }}"
    falcon_customer_id: "{{ lookup('env', 'CROWDSTRIKE_CUSTOMER_ID') }}"
    api_base_url: "https://api.laggar.gcw.crowdstrike.com"
