---
# Parameters:
# step_prepare: A shell command snippet to execute

- fail:
    msg: "A step_prepare is required. Create this entry in your user config file"
  when: step_prepare is not defined

- name: ensure tar is installed for script execution
  yum:
    pkg:
      - tar
    state: present
  become: yes

- name: Run prepare step
  shell: "{{step_prepare}}"
  async: 600
  register: output
  become: true
- fail:
    msg: "The command failed to install when it was expected to succeed:{{ output.stdout }}"
  when: output is failed
