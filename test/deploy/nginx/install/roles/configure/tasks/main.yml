---
- debug:
    msg: Install NGINX reverse proxy

- name: install the NGINX engine
  yum:
    name: nginx-1.12.1
    state: installed
    update_cache: yes
  become: true

- name: Configure nginx default route with status module
  blockinfile:
    path: /etc/nginx/conf.d/default.conf
    insertbefore: ".*location /*."
    marker: "# {mark} Enable status for default route"
    block: |
        location = /status {
            stub_status;
        }
  become: yes

- name: Restart nginx
  shell: "systemctl restart nginx"
  become: yes
